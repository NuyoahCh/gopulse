# ğŸ“® EinoFlow API é›†åˆä½¿ç”¨æŒ‡å—

## ğŸ“¥ å¯¼å…¥æ–¹æ³•

### ApiPost å¯¼å…¥

1. **æ‰“å¼€ ApiPost**
2. **ç‚¹å‡»å·¦ä¸Šè§’ "å¯¼å…¥"**
3. **é€‰æ‹© "å¯¼å…¥æ–‡ä»¶"**
4. **é€‰æ‹© `EinoFlow_API_Collection.json`**
5. **ç‚¹å‡» "ç¡®å®š"**

### Postman å¯¼å…¥

1. **æ‰“å¼€ Postman**
2. **ç‚¹å‡»å·¦ä¸Šè§’ "Import"**
3. **æ‹–æ‹½ `EinoFlow_API_Collection.json` æ–‡ä»¶**
4. **æˆ–ç‚¹å‡» "Upload Files" é€‰æ‹©æ–‡ä»¶**
5. **ç‚¹å‡» "Import"**

### Apifox å¯¼å…¥

1. **æ‰“å¼€ Apifox**
2. **ç‚¹å‡» "å¯¼å…¥æ•°æ®"**
3. **é€‰æ‹© "Postman" æ ¼å¼**
4. **ä¸Šä¼  `EinoFlow_API_Collection.json`**
5. **ç‚¹å‡» "ç¡®è®¤å¯¼å…¥"**

---

## ğŸ“‚ API é›†åˆç»“æ„

```
EinoFlow API Collection
â”œâ”€â”€ å¥åº·æ£€æŸ¥
â”‚   â””â”€â”€ Health Check
â”œâ”€â”€ LLM èŠå¤©
â”‚   â”œâ”€â”€ è·å–æ¨¡å‹åˆ—è¡¨
â”‚   â”œâ”€â”€ LLM èŠå¤© - è±†åŒ…æ¨¡å‹
â”‚   â”œâ”€â”€ LLM èŠå¤© - å¤šè½®å¯¹è¯
â”‚   â””â”€â”€ LLM æµå¼èŠå¤©
â”œâ”€â”€ RAG æ£€ç´¢å¢å¼º
â”‚   â”œâ”€â”€ ç´¢å¼•æ–‡æ¡£
â”‚   â”œâ”€â”€ RAG æŸ¥è¯¢
â”‚   â”œâ”€â”€ æŸ¥çœ‹æ–‡æ¡£ç»Ÿè®¡
â”‚   â””â”€â”€ æ¸…ç©ºæ–‡æ¡£
â”œâ”€â”€ Agent æ™ºèƒ½ä½“
â”‚   â”œâ”€â”€ Agent æ‰§è¡Œ - å¤©æ°”æŸ¥è¯¢
â”‚   â”œâ”€â”€ Agent æ‰§è¡Œ - è®¡ç®—å™¨
â”‚   â””â”€â”€ Agent æ‰§è¡Œ - æœç´¢
â”œâ”€â”€ Chain é“¾å¼ç¼–æ’
â”‚   â”œâ”€â”€ Chain æ‰§è¡Œ - é¡ºåºé“¾
â”‚   â””â”€â”€ Chain æ‰§è¡Œ - å¹¶è¡Œé“¾
â”œâ”€â”€ Graph å·¥ä½œæµ
â”‚   â”œâ”€â”€ Graph æ‰§è¡Œ - ç®€å•å·¥ä½œæµ
â”‚   â””â”€â”€ Graph æ‰§è¡Œ - æ¡ä»¶åˆ†æ”¯
â”œâ”€â”€ å¤šæ¨¡æ€
â”‚   â”œâ”€â”€ å›¾åƒç†è§£ - URL
â”‚   â””â”€â”€ å›¾åƒç†è§£ - Base64
â””â”€â”€ æµ‹è¯•åœºæ™¯
    â”œâ”€â”€ å®Œæ•´ RAG æµç¨‹
    â”‚   â”œâ”€â”€ 1. æ¸…ç©ºæ—§æ•°æ®
    â”‚   â”œâ”€â”€ 2. ç´¢å¼•æ–°æ–‡æ¡£
    â”‚   â””â”€â”€ 3. æŸ¥è¯¢æ–‡æ¡£
    â””â”€â”€ ä¸Šä¸‹æ–‡çª—å£æµ‹è¯•
```

---

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

é›†åˆä¸­ä½¿ç”¨äº†ç¯å¢ƒå˜é‡ `{{base_url}}`ï¼Œé»˜è®¤å€¼ä¸º `http://localhost:8080`

### ä¿®æ”¹ç¯å¢ƒå˜é‡

#### ApiPost
1. ç‚¹å‡»å³ä¸Šè§’ "ç¯å¢ƒ"
2. é€‰æ‹©æˆ–åˆ›å»ºç¯å¢ƒ
3. æ·»åŠ å˜é‡ï¼š
   - å˜é‡åï¼š`base_url`
   - å½“å‰å€¼ï¼š`http://localhost:8080`

#### Postman
1. ç‚¹å‡»å³ä¸Šè§’é½¿è½®å›¾æ ‡ âš™ï¸
2. é€‰æ‹© "Manage Environments"
3. æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
   - Variable: `base_url`
   - Initial Value: `http://localhost:8080`

#### Apifox
1. ç‚¹å‡»å·¦ä¾§ "ç¯å¢ƒç®¡ç†"
2. æ·»åŠ å˜é‡ï¼š
   - å˜é‡åï¼š`base_url`
   - å€¼ï¼š`http://localhost:8080`

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡
```bash
cd /Users/wangchen/GolandProjects/einoflow
make run
```

### 2. æµ‹è¯•å¥åº·æ£€æŸ¥
åœ¨ API å®¢æˆ·ç«¯ä¸­æ‰¾åˆ° **"å¥åº·æ£€æŸ¥ > Health Check"**ï¼Œç‚¹å‡» **"å‘é€"**

**é¢„æœŸå“åº”ï¼š**
```json
{
  "status": "healthy",
  "time": "2025-01-17T09:45:00Z"
}
```

### 3. æµ‹è¯• LLM èŠå¤©
æ‰¾åˆ° **"LLM èŠå¤© > LLM èŠå¤© - è±†åŒ…æ¨¡å‹"**ï¼Œç‚¹å‡» **"å‘é€"**

**é¢„æœŸå“åº”ï¼š**
```json
{
  "message": {
    "role": "assistant",
    "content": "ä½ å¥½ï¼æˆ‘æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹..."
  }
}
```

---

## ğŸ“ å¸¸ç”¨æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1ï¼šå®Œæ•´ RAG æµç¨‹

æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸‹è¯·æ±‚ï¼š

1. **æ¸…ç©ºæ—§æ•°æ®**
   - è·¯å¾„ï¼š`æµ‹è¯•åœºæ™¯ > å®Œæ•´ RAG æµç¨‹ > 1. æ¸…ç©ºæ—§æ•°æ®`
   - æ–¹æ³•ï¼šDELETE
   - è¯´æ˜ï¼šæ¸…ç©ºå‘é‡æ•°æ®åº“

2. **ç´¢å¼•æ–°æ–‡æ¡£**
   - è·¯å¾„ï¼š`æµ‹è¯•åœºæ™¯ > å®Œæ•´ RAG æµç¨‹ > 2. ç´¢å¼•æ–°æ–‡æ¡£`
   - æ–¹æ³•ï¼šPOST
   - è¯´æ˜ï¼šæ·»åŠ æ–‡æ¡£åˆ°å‘é‡æ•°æ®åº“

3. **æŸ¥è¯¢æ–‡æ¡£**
   - è·¯å¾„ï¼š`æµ‹è¯•åœºæ™¯ > å®Œæ•´ RAG æµç¨‹ > 3. æŸ¥è¯¢æ–‡æ¡£`
   - æ–¹æ³•ï¼šPOST
   - è¯´æ˜ï¼šåŸºäºè¯­ä¹‰æ£€ç´¢å›ç­”é—®é¢˜

### åœºæ™¯ 2ï¼šä¸Šä¸‹æ–‡çª—å£æµ‹è¯•

æ‰¾åˆ° **"æµ‹è¯•åœºæ™¯ > ä¸Šä¸‹æ–‡çª—å£æµ‹è¯•"**ï¼Œç‚¹å‡»å‘é€

**è¯´æ˜ï¼š** æµ‹è¯•è¶…é•¿å¯¹è¯çš„è‡ªåŠ¨æˆªæ–­åŠŸèƒ½

**æŸ¥çœ‹æ•ˆæœï¼š**
- æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
- åº”è¯¥çœ‹åˆ°ï¼š`Context truncated: 11 -> X messages`

### åœºæ™¯ 3ï¼šå¤šæ¨¡æ€å›¾åƒç†è§£

æ‰¾åˆ° **"å¤šæ¨¡æ€ > å›¾åƒç†è§£ - URL"**ï¼Œç‚¹å‡»å‘é€

**è¯´æ˜ï¼š** æµ‹è¯•å›¾åƒç†è§£åŠŸèƒ½ï¼ˆéœ€è¦æ”¯æŒå¤šæ¨¡æ€çš„æ¨¡å‹ï¼‰

---

## ğŸ¯ API è¯¦ç»†è¯´æ˜

### LLM èŠå¤© API

#### åŸºç¡€èŠå¤©
```json
POST /api/v1/llm/chat
{
  "model": "doubao-seed-1-6-lite-251015",
  "messages": [
    {"role": "user", "content": "ä½ å¥½"}
  ]
}
```

#### å¤šè½®å¯¹è¯
```json
POST /api/v1/llm/chat
{
  "model": "doubao-seed-1-6-lite-251015",
  "messages": [
    {"role": "system", "content": "ä½ æ˜¯åŠ©æ‰‹"},
    {"role": "user", "content": "é—®é¢˜1"},
    {"role": "assistant", "content": "å›ç­”1"},
    {"role": "user", "content": "é—®é¢˜2"}
  ]
}
```

#### æµå¼å“åº”
```json
POST /api/v1/llm/chat/stream
{
  "model": "doubao-seed-1-6-lite-251015",
  "messages": [
    {"role": "user", "content": "å†™ä¸€é¦–è¯—"}
  ]
}
```

### RAG API

#### ç´¢å¼•æ–‡æ¡£
```json
POST /api/v1/rag/index
{
  "documents": [
    "æ–‡æ¡£å†…å®¹1",
    "æ–‡æ¡£å†…å®¹2"
  ]
}
```

#### æŸ¥è¯¢
```json
POST /api/v1/rag/query
{
  "query": "ä½ çš„é—®é¢˜"
}
```

### Agent API

```json
POST /api/v1/agent/run
{
  "input": "åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
}
```

### Chain API

```json
POST /api/v1/chain/run
{
  "type": "sequential",  // æˆ– "parallel"
  "input": "è¾“å…¥å†…å®¹"
}
```

### Graph API

```json
POST /api/v1/graph/run
{
  "input": "å·¥ä½œæµè¾“å…¥"
}
```

### å¤šæ¨¡æ€ API

```json
POST /api/v1/multimodal/chat
{
  "text": "è¿™å¼ å›¾ç‰‡é‡Œæœ‰ä»€ä¹ˆï¼Ÿ",
  "image_url": "https://example.com/image.jpg"
}
```

---

## ğŸ” å“åº”å­—æ®µè¯´æ˜

### æˆåŠŸå“åº”

æ‰€æœ‰æˆåŠŸçš„å“åº”éƒ½ä¼šåŒ…å« `X-Request-ID` å“åº”å¤´ï¼Œç”¨äºè¿½è¸ªè¯·æ±‚ã€‚

#### LLM èŠå¤©å“åº”
```json
{
  "message": {
    "role": "assistant",
    "content": "å›ç­”å†…å®¹"
  },
  "finish_reason": "stop"
}
```

#### RAG æŸ¥è¯¢å“åº”
```json
{
  "answer": "åŸºäºæ£€ç´¢çš„å›ç­”",
  "documents": [
    "ç›¸å…³æ–‡æ¡£1",
    "ç›¸å…³æ–‡æ¡£2"
  ]
}
```

### é”™è¯¯å“åº”

```json
{
  "error": "é”™è¯¯æè¿°",
  "request_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

**å¸¸è§é”™è¯¯ç ï¼š**
- `400` - è¯·æ±‚æ ¼å¼é”™è¯¯
- `404` - èµ„æºä¸å­˜åœ¨
- `500` - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

---

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. æ‰¹é‡æµ‹è¯•
åœ¨ ApiPost/Postman ä¸­å¯ä»¥ä½¿ç”¨ **"Runner"** åŠŸèƒ½æ‰¹é‡æ‰§è¡Œè¯·æ±‚

### 2. ä¿å­˜å“åº”
ç‚¹å‡» **"ä¿å­˜ä¸ºç¤ºä¾‹"** å¯ä»¥ä¿å­˜å“åº”ä½œä¸ºå‚è€ƒ

### 3. ç¯å¢ƒåˆ‡æ¢
åˆ›å»ºå¤šä¸ªç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰ï¼Œå¿«é€Ÿåˆ‡æ¢

### 4. å˜é‡ä½¿ç”¨
åœ¨è¯·æ±‚ä¸­ä½¿ç”¨ `{{variable}}` å¼•ç”¨å˜é‡

### 5. è„šæœ¬æµ‹è¯•
åœ¨ **"Tests"** æ ‡ç­¾ä¸­æ·»åŠ æ–­è¨€ï¼š
```javascript
// æ£€æŸ¥çŠ¶æ€ç 
pm.test("Status is 200", function () {
    pm.response.to.have.status(200);
});

// æ£€æŸ¥å“åº”åŒ…å«å­—æ®µ
pm.test("Response has message", function () {
    pm.expect(pm.response.json()).to.have.property('message');
});
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: è¿æ¥å¤±è´¥
**A:** ç¡®ä¿æœåŠ¡å·²å¯åŠ¨ï¼š
```bash
make run
```

### Q2: 404 é”™è¯¯
**A:** æ£€æŸ¥ URL è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿åŒ…å« `/api/v1` å‰ç¼€

### Q3: 500 é”™è¯¯
**A:** æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼Œæ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®ï¼ˆAPI Keys ç­‰ï¼‰

### Q4: Request ID åœ¨å“ªé‡Œï¼Ÿ
**A:** åœ¨å“åº”å¤´ä¸­æŸ¥æ‰¾ `X-Request-ID`

### Q5: å¦‚ä½•æŸ¥çœ‹æµå¼å“åº”ï¼Ÿ
**A:** æµå¼å“åº”ä½¿ç”¨ SSEï¼ˆServer-Sent Eventsï¼‰ï¼Œåœ¨å®¢æˆ·ç«¯ä¸­æŸ¥çœ‹ **"å“åº”"** æ ‡ç­¾

---

## ğŸ“Š æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] LLM èŠå¤©æ­£å¸¸
- [ ] LLM æµå¼èŠå¤©æ­£å¸¸
- [ ] è·å–æ¨¡å‹åˆ—è¡¨æˆåŠŸ
- [ ] RAG ç´¢å¼•æ–‡æ¡£æˆåŠŸ
- [ ] RAG æŸ¥è¯¢è¿”å›æ­£ç¡®ç»“æœ
- [ ] Agent æ‰§è¡ŒæˆåŠŸ
- [ ] Chain æ‰§è¡ŒæˆåŠŸ
- [ ] Graph æ‰§è¡ŒæˆåŠŸ
- [ ] å¤šæ¨¡æ€æ¥å£å¯è®¿é—®
- [ ] æ‰€æœ‰å“åº”éƒ½åŒ…å« Request ID
- [ ] é”™è¯¯å“åº”æ ¼å¼æ­£ç¡®

---

## ğŸ¨ è‡ªå®šä¹‰è¯·æ±‚

### æ·»åŠ æ–°è¯·æ±‚

1. å³é”®ç‚¹å‡»æ–‡ä»¶å¤¹
2. é€‰æ‹© **"æ·»åŠ è¯·æ±‚"**
3. å¡«å†™è¯·æ±‚ä¿¡æ¯
4. ä¿å­˜

### ä¿®æ”¹ç°æœ‰è¯·æ±‚

1. ç‚¹å‡»è¯·æ±‚
2. ä¿®æ”¹ URLã€Headersã€Body
3. ç‚¹å‡» **"ä¿å­˜"**

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **Swagger UI**: http://localhost:8080/swagger/index.html
- **é¡¹ç›® README**: `/Users/wangchen/GolandProjects/einoflow/README.md`
- **æ”¹è¿›æŠ¥å‘Š**: `/Users/wangchen/GolandProjects/einoflow/IMPROVEMENTS_COMPLETED.md`

---

## ğŸ‰ æ€»ç»“

è¿™ä¸ª API é›†åˆåŒ…å«äº† EinoFlow çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼š

âœ… **20+ ä¸ªé¢„é…ç½®è¯·æ±‚**
âœ… **å®Œæ•´çš„æµ‹è¯•åœºæ™¯**
âœ… **è¯¦ç»†çš„è¯·æ±‚ç¤ºä¾‹**
âœ… **ç¯å¢ƒå˜é‡é…ç½®**
âœ… **é”™è¯¯å¤„ç†ç¤ºä¾‹**

**å¼€å§‹æµ‹è¯•å§ï¼** ğŸš€

---

**æœ€åæ›´æ–°ï¼š** 2025-01-17
**é›†åˆç‰ˆæœ¬ï¼š** 1.0.0
**æ”¯æŒçš„å®¢æˆ·ç«¯ï¼š** ApiPost, Postman, Apifox
